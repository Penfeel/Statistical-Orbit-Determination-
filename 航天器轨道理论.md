<h1 align = "center">航天器轨道理论</h1>

## 1.二体问题

### 1.1基本方程

$$
\ddot{\boldsymbol{r}}=-\frac{G(M+m)}{r^{2}} \hat{\boldsymbol{r}}
$$

>  其中 $\hat{r}=\boldsymbol{r} / r$ 其 $M$ 到 $m$ 方向 (径向) 的单位矢量

1. 有心力的角动量守恒——确定轨道平面
   $$
   \boldsymbol{h}=\boldsymbol{r} \times \dot{\boldsymbol{r}}={h} \mathbf{\boldsymbol { R }}
   $$
   其中 $h=|r \times \dot{r}|$ 为面积速度常数。上式不随时间改变，显然, 天体 $m$ 相对 $M$ 的运动为 一平面运动,表示面积速度方向的单位矢量 $\hat{R}$ 是该运动平面的法向单位矢量。

   用角度信息表示出 $\hat{R}$ 
   $$
   \hat{\mathbf{R}}=\left(\begin{array}{c}\sin i \sin \Omega \\ -\sin i \cos \Omega \\ \cos i\end{array}\right)
   $$
    具体角度含义是什么先不管，但是肯定需要**两个角度**来表示（参考球坐标）

2. 平面内的轨道形状确定

解出平面的椭圆方程为
$$
r=\frac{a\left(1-e^{2}\right)}{1+e \cos (\theta-\omega)}
$$

>  积分常数 $h$ 由 $a$ 代替。 $p$ 是椭圆半通径, $a$ 是半长径, $e$ 是离心率, 对椭圆而言, 有 $a>0,0 \leqslant e<1$ 。

其中a和e是大小形状，$\omega$  代表着图形的旋转的角度。

3. 轨道确定位置

由1，2轨道已经确定，还需要一个量来确定位置
$$
E-e \sin E=h(t-\tau)
$$

> 这又称为**开普勒方程**， $\tau$ 是第六个积分常数, 当 $t=\tau$ 时, $E=0$, 相应的 $r=a(1-e)=r_{\text {min }}$, 故 $\tau$ 就是天体 $m$ 过近星点的时刻。

<img src="C:\Users\徐鹏飞\AppData\Roaming\Typora\typora-user-images\image-20221103170736165.png" alt="image-20221103170736165" style="zoom:50%;" /><img src="C:\Users\徐鹏飞\AppData\Roaming\Typora\typora-user-images\image-20221103222337717.png" alt="image-20221103222337717" style="zoom:50%;" />

$f =\theta- \omega$ ，称为真近点角，E为偏近点角，$M=h(t-\tau)$,为平近点角

$r=a(1-e \cos E)$

上述六个独立积分常数又称为**轨道根数**, 只要初始条件给定, 它们就完全被确定,而且几何意义很明确。a, $e$ 是确定轨道大小和形状的根数; $i, \Omega$ 种 $\omega$ 是轨道平面和半长轴的空间定向根数.第六个根数 $\tau$ 往往被三种近点角之一所代替,特别是平近点角 $M$ 常被引用。三种近点角本身并不是常数, 它们均随 $t$ 变化,故也被称作时间系数。

### 1.2椭圆基本关系式

上述六个积分已完全确定了二体问题意义下天体的运动, 但这六个积分的表达形式有时使用不便, 有必要在它们的基础上导出一些常用关系式。这些关系式所涉及的量, 不外平六个根数, 时间 $t$, 各种**近点角**, 向径和速度等。

1.
$$
r=\frac{a\left(1-e^{2}\right)}{1+e \cos f}=a(1-e \cos E)
$$

$$
E-e \sin E=M
$$

 导出：
$$
\begin{aligned} r \sin f &=a \sqrt{1-e^{2}} \sin E \\ \operatorname{tg} \frac{f}{2} &=\sqrt{\frac{1+e}{1-e}} \operatorname{tg} \frac{E}{2} \end{aligned}
$$
2.位置矢量$\boldsymbol{r}$和速度矢量 $\boldsymbol{\dot{r}}$的表达式
$$
\begin{aligned} \boldsymbol{r}=& r \hat{r}=r \cos f \hat{P}+r \sin f \hat{Q}= a(\cos E-e) \hat{P}+a \sqrt{1-e^{2}} \sin E \hat{Q} \end{aligned}
$$

$$
\begin{aligned} \boldsymbol{\dot{r}}=-\sqrt{\frac{\mu}{p}}[\sin f \hat{P}-(\cos f+e) \hat{Q}] = &-\frac{\sqrt{\mu a}}{r}\left(\sin E \hat{P}-\sqrt{1-e^{2}} \cos E \hat{Q}\right) \end{aligned}
$$



暂略

### 1.3开普勒方程的解法

在二体问题意义下,由已知的椭圆轨道计算天体的历表时, 关键的一步是由轨道根数计算天体的位置矢量 $\boldsymbol{r}$ 和速度矢量 $\boldsymbol{\dot{r}}$ 。如果轨道根数中第六个时间根数采用真近点角 $f$ 或偏近点角 $E$,则由1.2可以轻易计算出位置矢量 $\boldsymbol{r}$ 和速度矢量 $\boldsymbol{\dot{r}}$，实际上一般第六个根数一般是$M$，则要解出超越方程$E-e \sin E=M$,一般采用迭代法和牛顿法数值求解出E。

1. 迭代法
    由于 $e<1$, 下述迭代过程是收敛的
$$
  E_{k+1}=M+e \sin E_{k}, k=0,1, \cdots
$$

2. 牛顿法记
    $f(E)=(E-e \sin E)-M$
    根据
$$
  \left\{\begin{array}{l}
  f\left(E_{k+1}\right)=f\left(E_{k}\right)+f^{\prime}\left(E_{k}\right)\left(E_{k+1}-E_{k}\right)+\cdots \\
  f^{\prime}\left(E_{k}\right)=1-e \cos E_{k}
  \end{array}\right.
$$
  且只取到一阶导数, 有
$$
  E_{k+1}=E_{k}-\frac{f\left(E_{k}\right)}{f^{\prime}\left(E_{k}\right)}, k=0,1, \cdots
$$
  这种简单的牛顿法也就是微分改正法。

### 1.4抛物线与双曲线

暂略





## 2.轨道计算

从原理上看, 基本上可以归结为两大类,一类是通过三次观测首先确定历元时刻的 $\boldsymbol{r}$ 和 $\boldsymbol{\dot{r}}$, 继而给出相应的轨道根数 $\sigma$; 另一类则是通过三次观测计算相应的位置矢量 $r_{j}(j=1,2,3)$, 从而确定某一历元的轨道根数 $\sigma$ 。前者是是**拉普拉斯方法**, 后一类即**高斯 (Gauss) 方法**。即使用多点 (即多次 观测) 进行定轨, 只要仍在二体问题意义下, 相应的定轨方法也不 会发生根本性的改变, 只是可以利用多资料的统计特性提高定轨的精度而已。
从微分方程初值问题的角度来看, 初轨计算就是根据观测来 确定二体问题的六个积分常数, 即六个椭圆轨道根数: $a_{0}, e_{0}, i_{0}$, $\Omega_{0}, \omega_{0}, M_{0}$, 也可以是 $\boldsymbol{r}_{0}, \dot{r}_{0}$ 。如果能由观测直接给出 $\boldsymbol{r}$ 和 $\boldsymbol{\dot{r}}$, 那么 就不存在初轨计算问题。然而, 对于光学观测而言, 通常无法直接得到 $\boldsymbol{r}$ 和 $\boldsymbol{\dot{r}}$ 或两个时刻 $\left(t_{1}\right.$ 和 $\left.t_{2}\right)$ 的位置矢量 $\boldsymbol{r}_{1}$ 和 $\boldsymbol{r}_{2}$, 只能获得天体的方位, 如赤经赤纬 $(\alpha, \delta)$, 或方位角、高度角 $(A, h)$ 。 <font color=red>因此,初轨计算问题实际上就归结为由观测值 $(\alpha, \delta)$ 或 $(A, h)$ 计算某一历元 $t_{0}$ 的 $\boldsymbol{r}_{\mathbf{0}}$ 和 $\boldsymbol{\dot{r}}_{0}$, 或两个时刻的位置矢量 $\boldsymbol{r}_{1}$ 和 $\boldsymbol{r}_{2}$。</font>

### 后续补具体计算



## 3.摄动问题

之前的六个轨道根数c1-c6不再是常值，应为t的函数。

根据1.2可知
$$
\boldsymbol{r}=\boldsymbol{f}\left(c_{1}, c_{2}, \cdots, c_{6}, t\right)
$$

$$
\dot{\boldsymbol{r}}=\boldsymbol{g}\left(c_{1}, c_{2}, \cdots, c_{6}, t\right)
$$

$$
\dot{\boldsymbol{r}}=\frac{\partial \boldsymbol{r}}{\partial t}=\frac{\partial \boldsymbol{f}}{\partial t}
$$

对$\boldsymbol{r}=\boldsymbol{f}\left(c_{1}, c_{2}, \cdots, c_{6}, t\right)$求导
$$
\frac{\mathrm{d} \boldsymbol{r}}{\mathrm{d} t}=\frac{\partial f}{\partial t}+\sum_{j=1}^{6} \frac{\partial f}{\partial c_{j}} \frac{\mathrm{d} c_{j}}{\mathrm{~d} t}
$$

$$
\frac{\mathrm{d} \boldsymbol{r}}{\mathrm{~d} t}=\frac{\partial f}{\partial t}=g\left(c_{1}, c_{2}, \cdots, c_{6}, t\right)
$$

也就是说上式的右边不应该显含$ \frac{\mathrm{d} c_{j}}{\mathrm{~d} t}$的项，所以
$$
\sum_{j=1}^{6} \frac{\partial f}{\partial c_{j}} \frac{\mathrm{d} c_{j}}{\mathrm{~d} t}=0
$$
对$\boldsymbol{r}=\boldsymbol{f}\left(c_{1}, c_{2}, \cdots, c_{6}, t\right)$求两次导
$$
\frac{\mathrm{d}^{2} \boldsymbol{r}}{\mathrm{d} t^{2}}=\frac{\partial \boldsymbol{R}}{\partial t}+\sum_{j=1}^{6} \frac{\partial \boldsymbol{q}}{\partial c_{j}} \frac{\mathrm{d} c_{j}}{\mathrm{~d} t}=\boldsymbol{F}_{0}+\boldsymbol{F}_{\varepsilon}
$$
其中$\frac{\partial g}{\partial t}=\boldsymbol{F}_{0}$,${F}_{\varepsilon}$为摄动力

于是得到了摄动方程
$$
\left\{\begin{array}{l}
\sum_{j=1}^{6} \frac{\partial f}{\partial c_{j}} \frac{\mathrm{d} c_{j}}{\mathrm{~d} t}=0 \\
\sum_{j=1}^{6} \frac{\partial g}{\partial c_{j}} \frac{\mathrm{d} c_{j}}{\mathrm{~d} t}=F_{\varepsilon}
\end{array}\right.
$$
其中 $\partial f / \partial c_{j}$ 和 $\partial g / \partial c_{j}$ 都是 $c_{j}$ 和 $t$ 的已知函数,这毕作导数中除 $\partial f / \partial \tau$ 利 $\partial g / \partial \tau$ 外, 在书的第二章中均已给出。原则上可由这一方程组导出 $\mathrm{d} c_{j} / \mathrm{d} t$ 的显形式:
$$
\frac{\mathrm{d} c_{j}}{\mathrm{~d} t}=f_{j}\left(c_{1}, c_{2}, \cdots, c_{6}, t ; \varepsilon\right), \quad j=1,2, \cdots, 6
$$
此即我们所需要的**摄动运动方程**。


